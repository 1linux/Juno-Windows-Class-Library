<html>
		<head>
		<title>Module juno.com.core</title>
		</head>
		<style>
		body { font-family: Verdana, Arial; font-size: 8pt; }
		table { font-family: Verdana, Arial; font-size: 8pt; }
		h1 { font-size: 17pt; font-weight: normal; }
		h2 { font-size: 15pt; font-weight: normal; }
		.decl { font-family: Tahoma; font-size: 14pt; }
		.psymbol { color: #336699; }
		.package { font-size: 8pt; }
		.module { font-family: Tahoma; font-size: 14pt; }
		.paramid { }
		.paramdesc { padding-left: 40px; }
		.member-table { border-collapse: collapse; }
		.d_code { font-family: Consolas; font-size: 10pt; background-color: #EEEEEE; border: 1px #CCCCCC dashed; }
		</style>
		<body>
		<p>
		<div class="package">Juno Class Library</div>
		<div class="module">Module juno.com.core</div>
		</p>
		<!-- Generated by Ddoc from ..\juno\com\core.d -->
Provides support for the Component Object Model (COM).
<br><br>
To ensure COM objects are freed before COM is shut down, place this file last on your command line.
 
<br><br>

<dl><dt><span class="decl">struct <span class="psymbol">GUID</span>;
</span></dt>
<dd>Represents a globally unique identifier.
 
<br><br>

<dl><dt><span class="decl">static GUID  <span class="psymbol">opCall</span>(char[] <i>s</i>);
</span></dt>
<dd><i>Constructor.</i>
 Initializes a GUID using the value represented by the specified string.
<br><br>
<b>Parameters</b><br><div class="paramid">char[] <i>s</i></div>
<div class="paramdesc">A string containing a GUID in the formats dddddddd-dddd-dddd-dddd-dddddddddddd or {dddddddd-dddd-dddd-dddd-dddddddddddd}.</div><br>

<b>Exceptions</b><br>FormatException if the format of <i>s</i> is invalid.
   
<br><br>

</dd>
<dt><span class="decl">static GUID  <span class="psymbol">newGuid</span>();
</span></dt>
<dd>Initializes a new instance.
   
<br><br>

</dd>
<dt><span class="decl">char[] <span class="psymbol">toString</span>();
</span></dt>
<dd>Returns a string representation of the value in the format {dddddddd-dddd-dddd-dddd-dddddddddddd}.
   
<br><br>

</dd>
</dl>
</dd>
<dt><span class="decl">struct <span class="psymbol">VARIANT</span>;
</span></dt>
<dd>Represents a variable type that can be passed to COM methods.
 
<br><br>

<dl><dt><span class="decl">static VARIANT  <span class="psymbol">opCall</span>(bool <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(ubyte <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(byte <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(ushort <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(short <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(uint <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(int <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(ulong <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(long <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(float <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(double <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(char[] <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(DECIMAL <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(IUnknown <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(Object <i>value</i>);
<br>static VARIANT  <span class="psymbol">opCall</span>(SAFEARRAY * <i>value</i>);
</span></dt>
<dd>Initializes the VARIANT with the specified <i>value</i>.
   
<br><br>

</dd>
<dt><span class="decl">void <span class="psymbol">clear</span>();
</span></dt>
<dd>Releases any resources held by the VARIANT.
   
<br><br>

</dd>
<dt><span class="decl">void <span class="psymbol">copyTo</span>(out VARIANT <i>dest</i>);
</span></dt>
<dd>Makes an exact copy of the current instance.
   
<br><br>

</dd>
<dt><span class="decl">char[] <span class="psymbol">toString</span>();
</span></dt>
<dd>Returns a string representation of the current instance.
<br><br>
If the VARIANT is of type VT_BSTR, the value is converted to a UTF-8 string and the BSTR's memory freed. For all other types, the value of the VARIANT is
 first converted to a BSTR, then to a UTF-8 string.
   
<br><br>

</dd>
</dl>
</dd>
<dt><span class="decl">bool <span class="psymbol">SUCCEEDED</span>(int <i>hr</i>);
</span></dt>
<dd>Determines whether the operation on a COM method succeeded.
<br><br>
<b>Returns</b><br><b>true</b> if the operation succeeded; otherwise, <b>false</b>.
 
<br><br>

</dd>
<dt><span class="decl">bool <span class="psymbol">FAILED</span>(int <i>hr</i>);
</span></dt>
<dd>Determines whether the operation on a COM method failed.
<br><br>
<b>Returns</b><br><b>true</b> if the operation failed; otherwise, <b>false</b>.
 
<br><br>

</dd>
<dt><span class="decl">class <span class="psymbol">COMException</span>: juno.base.core.Throwable;
</span></dt>
<dd>The exception thrown when a COM error occurs.
 
<br><br>

<dl><dt><span class="decl">this(char[] <i>message</i>);
</span></dt>
<dd>Creates an instance with the specified error message.
   
<br><br>

</dd>
<dt><span class="decl">this(int <i>error</i> = -2147467259);
</span></dt>
<dd>Creates an instance with the specified error code (HRESULT). The default is E_FAIL.
   
<br><br>

</dd>
<dt><span class="decl">this(int <i>error</i>, char[] <i>message</i>);
</span></dt>
<dd>Creates an instance with the specified HRESULT of the error and the error message.
   
<br><br>

</dd>
<dt><span class="decl">int <span class="psymbol">errorCode</span>();
</span></dt>
<dd>Retrieves the HRESULT of the error.
   
<br><br>

</dd>
</dl>
</dd>
<dt><span class="decl">class <span class="psymbol">Implements</span>(I0): I0;
<br>class <span class="psymbol">Implements</span>(I0,I1)<br>class <span class="psymbol">Implements</span>(I0,I1,I2)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4,I5)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4,I5,I6)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4,I5,I6,I7)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4,I5,I6,I7,I8)<br>class <span class="psymbol">Implements</span>(I0,I1,I2,I3,I4,I5,I6,I7,I8,I9)</span></dt>
<dd>An abstract base class for classes that implement one or more COM interfaces.
<br><br>
Subclasses do not need to implement their own QueryInterface, AddRef and Release methods, as the class provides default implementations of those methods.
<br><br>
<b>Examples</b><br><pre class="d_code"> <font color=blue>class</font> XmlDocumentEvents : Implements!(XMLDOMDocumentEvents) {
 }

 MyComObject docEvents = <font color=blue>new</font> MyComObject;
 docEvents.Invoke();
</pre>
 


<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">coCreate</span>(T,bool throws = false)</span></dt>
<dd>Implements CoCreateInstance.
<br><br>
<b>Parameters</b><br><div class="paramid">T</div>
<div class="paramdesc">The type of interface to instantiate.</div><br>
<div class="paramid">throws</div>
<div class="paramdesc"><b>true</b> to indicate that an exception is thrown if the instantiation failed; otherwise, <b>false</b>.</div><br>

<b>Examples</b><br><pre class="d_code"> IXMLDOMDocument3 doc = DOMDocument60.coCreate!(IXMLDOMDocument3);
</pre>
 


<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">CoInterfaces</span>(T...)</span></dt>
<dd>Defines a list of interfaces that a coclass implements and provides a method for instantiating instances of those interfaces. Intended to be used as a mixin.
 
<br><br>

<dl><dt><span class="decl">template <span class="psymbol">coCreate</span>(I,bool throws = false)</span></dt>
<dd>Implements CoCreateInstance.
<br><br>
<b>Parameters</b><br><div class="paramid">I</div>
<div class="paramdesc">The type of interface to instantiate.</div><br>
<div class="paramid">throws</div>
<div class="paramdesc"><b>true</b> to indicate that an exception is thrown if the instantiation failed; otherwise, <b>false</b>.</div><br>

<b>Examples</b><br><pre class="d_code"> <font color=green>// Declare the DOMDocument60 coclass.
</font> <font color=blue>abstract</font> <font color=blue>class</font> DOMDocument60 {
   <font color=blue>static</font> GUID CLSID = { 0x88d96a05, 0xf192, 0x11d4, 0xa6, 0x5f, 0x00, 0x40, 0x96, 0x32, 0x51, 0xe5 };
   <font color=blue>mixin</font> CoInterfaces!(IXMLDOMDocument3);
 }

 <font color=green>// Create an instance.
</font> IXMLDOMDocument3 doc = DOMDocument60.coCreate!(IXMLDOMDocument3);
</pre>
   


<dl></dl>
</dd>
</dl>
</dd>
<dt><span class="decl">int <span class="psymbol">tryRelease</span>(IUnknown <i>obj</i>);
</span></dt>
<dd>Calls IUnknown.Release and returns the object's reference count.
<br><br>
The call to Release is wrapped in a try-catch block to prevent access violations from being thrown if the object's reference count has reached zero.
 
<br><br>

</dd>
<dt><span class="decl">void <span class="psymbol">releaseAfter</span>(IUnknown <i>obj</i>, void delegate() <i>block</i>);
</span></dt>
<dd>Calls tryRelease after the delegate has been executed.
<br><br>
<b>Examples</b><br><pre class="d_code"> IXMLDOMDocument3 doc = DOMDocument60.coCreate!(IXMLDOMDocument3);
 releaseAfter (doc, {
   com_bool loaded;
   doc.load(<font color=red>"books.xml"</font>.toVariant(<font color=blue>true</font>), loaded);
 });
</pre>
 


</dd>
<dt><span class="decl">void <span class="psymbol">clearAfter</span>(inout VARIANT <i>var</i>, void delegate() <i>block</i>);
</span></dt>
<dd>Clears the VARIANT and releases any resources held after the delegate has been executed.
<br><br>
<b>Examples</b><br><pre class="d_code"> VARIANT dest = <font color=red>"books.xml"</font>.toVariant();
 clearAfter (dest, {
   xmldoc.save(dest);
 });
</pre>
 


</dd>
<dt><span class="decl">template <span class="psymbol">com_cast</span>(T)</span></dt>
<dd>Converts from one COM type to another COM type. If the conversion is not possible, returns <b>null</b>.
<br><br>
<span class="psymbol">com_cast</span> (and the variants below) calls the object's QueryInterface method, which in turn is required to call the AddRef method,
 incrementing the object's reference count.
 
<br><br>

<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">com_safe_cast</span>(T)</span></dt>
<dd>Converts from one COM type to another COM type. If the conversion is not possible, throws an exception.
<br><br>
<b>Exceptions</b><br>InvalidCastException if the conversion is not possible.
 
<br><br>

<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">com_release_cast</span>(T)</span></dt>
<dd>Converts from one COM type to another COM type. If the conversion is not possible, returns <b>null</b>.
<br><br>
After the conversion, this function calls the specified object's Release method, decrementing the reference count.
 
<br><br>

<dl></dl>
</dd>
<dt><span class="decl">wchar* <span class="psymbol">utf8ToBstr</span>(char[] <i>str</i>);
</span></dt>
<dd>Converts a UTF-8 string to a BSTR.
 
<br><br>

</dd>
<dt><span class="decl">char[] <span class="psymbol">bstrToUtf8</span>(wchar* <i>bstr</i>);
</span></dt>
<dd>Converts a BSTR to a UTF-8 string and frees the BSTR.
 
<br><br>

</dd>
<dt><span class="decl">uint <span class="psymbol">bstrLength</span>(wchar* <i>bstr</i>);
</span></dt>
<dd>Returns the length in characters of the BSTR.
 
<br><br>

</dd>
<dt><span class="decl">void <span class="psymbol">freeBstr</span>(wchar* <i>bstr</i>);
</span></dt>
<dd>Frees a BSTR previously allocated by utf8ToBstr.
 
<br><br>

</dd>
<dt><span class="decl">template <span class="psymbol">toVariant</span>(T)</span></dt>
<dd>Converts a basic type to a COM variant.
<br><br>
<b>Parameters</b><br><div class="paramid">value</div>
<div class="paramdesc">The value to convert.</div><br>
<div class="paramid">collectable</div>
<div class="paramdesc"><b>true</b> if the resulting VARIANT is to be freed when the GC runs; otherwise, <b>false</b>.</div><br>


<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">toSafeArray</span>(T)</span></dt>
<dd>Converts a dynamic array to a COM safe array.
<br><br>
<b>Examples</b><br><pre class="d_code"> <font color=blue>int</font>[] list = [ 1, 2, 3, 4 ];
 SAFEARRAY* sa = list.toSafeArray();
</pre>
 


<dl></dl>
</dd>
<dt><span class="decl">template <span class="psymbol">toArray</span>(T)</span></dt>
<dd>Converts a COM safe array to a dynamic array.
<br><br>
<b>Examples</b><br><pre class="d_code"> <font color=blue>void</font> test(SAFEARRAY* sa) {
   <font color=blue>int</font>[] list = toArray(sa);
 }
</pre>
 


<dl></dl>
</dd>
</dl>

		</body>
		</html>

